<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="evaluation">

<!--1. 스터디 카페당 후기 보기  -->
<select  id="evaluation_list"  parameterType="String"  resultType="Evaluation"  >
    select order_eval_id, order_eval_pwd, order_eval_title, order_eval_content, TO_CHAR(order_eval_regdate, 'YYYY-MM-DD') AS order_eval_regdate, order_eval_score, cafe_id, member_id 
            from ( select a.*, rownum rnum
                from (select * from Order_evaluation where cafe_id=#{cafe_id} order by order_eval_id desc)a)
  <![CDATA[
    where rnum >=1 AND rnum <=4
    ]]>
</select>

<!--2. 전체 후기 보기  -->
<select  id="evaluation_total_list" resultType="TotalEvaluation"  >
    select  cafe_id, cafe_image1, cafe_name, member_id, order_eval_score, order_eval_content 
            from ( select a.*, rownum rnum
                from (select c.cafe_id, c.cafe_image1, c.cafe_name, o.member_id, o.order_eval_score, o.order_eval_content from cafe c, order_evaluation o 
							where c.cafe_id = o.cafe_id order by o.order_eval_id desc)a)
  <![CDATA[
    where rnum >=1 AND rnum <=8
    ]]>
</select>

</mapper>
